文件名
file_reader.ts

功能概述
实现文件按行读取功能（功能1.1）和为文件内容添加行号前缀功能（功能1.3）。接收包含路径和可选行号范围的字符串，读取指定文件内容（或其指定范围），并为每一行添加[行号]前缀后返回。

类、接口、函数的签名和功能

类：FileReader
核心文件读取和行号标注类。

方法：private parsePathWithRange(filePathWithRange: string): { filePath: string; startLine: number | null; endLine: number | null } | null
- 功能：解析包含路径和行号范围的字符串。
- 输入：filePathWithRange - 格式如 path/to/file.txt, path/to/file.txt#2, path/to/file.txt#2:5 的字符串。
- 输出：成功时返回包含解析出的文件路径、起始行号、结束行号的对象；格式无效时返回 null。

方法：async readFile(filePathWithRange: string): Promise
- 功能：根据路径和可选范围读取文件内容，并为每行添加行号前缀。
- 输入：filePathWithRange - 指定文件路径和可选行号范围的字符串。
- 输出：Promise - 成功时返回带行号前缀的文件内容字符串；失败（文件不存在、读取错误、格式无效）时返回 null。

实现细节概述
1.  路径与范围解析：parsePathWithRange 方法通过 # 分割字符串获取路径和范围部分。范围部分再通过 : 分割获取起始和结束行号。对行号进行有效性校验（正整数、起始不大于结束）。
2.  文件读取：使用 Deno.readTextFile 异步读取文件内容。使用 try...catch 块捕获文件不存在或读取错误，并打印错误信息到控制台。
3.  内容处理：将读取到的文件内容按 r?n 分割成行数组，以兼容不同操作系统换行符。
4.  行范围处理：根据解析出的 startLine 和 endLine（1-based）计算出在数组中的索引范围（0-based），并使用 slice 提取指定范围的行。
5.  行号添加：遍历最终确定的行数组，使用 map 为每一行添加 [行号] 前缀，行号基于原始文件的行号（1-based）。
6.  结果返回：将处理后的带行号的行数组用 n 连接成字符串返回。

功能测试内容
1.  完整文件读取：测试读取不带行号范围的文件，验证返回内容包含所有行及正确的行号。
2.  单行读取：测试 #N 格式，验证只返回第 N 行且带有正确行号。
3.  多行范围读取：测试 #N1:N2 格式，验证返回 N1 到 N2 行的内容及对应行号。
4.  超出范围读取：测试请求的行号超出文件实际行数的情况，验证返回实际存在的行。
5.  空文件读取：测试读取空文件，验证返回空字符串 ""。
6.  文件不存在：测试读取不存在的文件路径，验证返回 null 并打印错误信息。
7.  路径格式错误：测试无效的 filePathWithRange 格式（如 #abc、path#1:2:3、path#2:1），验证返回 null。
8.  行号无效：测试行号为非数字、负数或零的情况，验证返回 null。
9.  行号边界：测试 #0、#-1 等边界情况，验证返回 null。

与其他功能的关系
- 功能 1.2 (文件内容管理)：已被废弃，不开发。
- 功能 1.4 (解析NPML引用)：FileReader 依赖功能 1.4 提供的 filePathWithRange 字符串来执行具体的文件读取操作。
- 功能 1.6 (生成NPML翻译请求文)：功能 1.6 在聚合文件内容时，需要调用 FileReader 来读取原始NPML文件及其所有引用文件的内容。