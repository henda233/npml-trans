# NPML翻译器 项目文档
版本：v0.0.1
接收NPML代码，输出NPML翻译请求文。
基于deno+ts。

## 一、项目功能
### 1.1 文件按行读取
读取文件时，可读取指定行数范围的文件内容。如果行数范围省略，则读取全部内容。
### 1.2 文件内容类[废弃，不开发]
实现一个存储和管理已读取的文件内容类。
### 1.3 文件内容行号显示
给文件内容的每一行开头增加行号，例如：
```python
[1]def main():
[2]    print("Hello NPML!")
```
### 1.4 NPML引用内容读取
在NPML代码中（已经读取的文件内容）会有形如：
```text
!(docs/project.md)
!(../routes/login.tsx)
!(docs/libs/start.md#5)
!(docs/fresh/islands.md#12:36)
```
这样的引用内容语法标记。以感叹号开头，括号里面为引用内容文件地址（绝对或者相对）。文件地址后面#指明具体的行数范围。
#<from>:<to>表示读取第from行到第to行的引用内容。如果只有#<number>表示只读取第number行内容。
如果没有#则读取全部引用内容。
提取并读取NPML代码中所有引用内容。

### 1.5 指定目录结构树生成
指定某个存在的目录路径，遍历其中所有文件夹和文件，生成一个目录树，形如：
```text
docs/
    libs/
        fresh/
    project.md
routes/
    api/
    index.tsx
islands/
deno.json
main.ts
```
### 1.6 NPML翻译请求文生成（文件内容聚合）
NPML翻译请求文格式如下：
```text
NPML代码:
[正文]
项目结构说明:
[正文]
文档引用:
[文档1正文]
---
[文档2正文]
---
...
代码引用:
[代码1正文]
---
[代码2正文]
---
...
```
指定某个NPML代码文件路径后，读取文件，并标上行号；
读取NPML代码中的所有引用内容，也标上行号；
生成指定目录路径的目录树（如果没有指明目录路径，省略为空）；
将引用内容分为文档和代码，在每个引用内容顶部加上：
```text
// docs/project.md
```
指明文件路径和文件名。多个引用内容之间用---隔开。
将上面内容按照NPML翻译请求文聚合整理为一个markdown文档。
最后的md文档有2种输出方式：
- 文件输出：在当前目录下输出该md文档，文件名为npml代码文件名；
- 剪切板输出：将md文档复制到剪切板上。

### 1.7 CLI工具参数使用说明显示
输出参数使用说明。

### 1.8 npml翻译器版本显示
输出当前npml翻译器的版本。

## 二、项目架构和运行流程
### 2.1 项目架构
项目为CLI工具，即运行在命令行的工具，通过指明参数来运行。
CLI工具名为npml，参数如下：
npml [npml_file_name]   :例如npml main.npml,在当前运行目录下生成npml翻译请求文的md文档。
npml -v                 :显示当前npml翻译器版本。
npml -h                 :显示参数使用说明。
npml -c                 :将npml翻译请求文复制到剪切板上，不生成md文档。
npml -t [dir_path]      :指明需要生成目录树的目录路径。
npml -dr                :不读取npml代码的引用内容。

### 2.2 项目运行流程
执行命令npml main.npml的项目运行流程如下：
- 读取main.npml的所有内容，并标上行号（1.1功能、1.3功能）；
- 读取main.npml中所有引用内容，每个引用文件标上行号（1.1功能、1.4功能）；
- 如果使用-t参数，生成指定目录的目录树（1.5功能）；
- 生成最终的npml翻译请求文md文档（1.6功能）。

## 三、项目开发范式
单一职责原则；
关注点分离；
依赖注入风格；
模块化设计；
组合大于继承。